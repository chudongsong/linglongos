# **“玲珑OS” 产品文档 (Product Document)**

| 文档状态 | \[正式版\] |
| :---- | :---- |
| **产品名称** | “玲珑” (LingLong) Web OS |
| **版本号** | V2.2 |
| **创建日期** | 2025年07月24日 |
| **创建人** | Gemini |

## **修订历史**

| 版本号 | 日期 | 修订内容 | 修订人 |
| :---- | :---- | :---- | :---- |
| V1.0 | 2025-07-23 | 创建初始PRD草稿。 | Gemini |
| V1.1 | 2025-07-23 | 新增登录与关于页面模块。 | Gemini |
| V2.0 | 2025-07-24 | 整合所有模块，新增项目架构图与规划，并深化架构设计。 | Gemini |
| V2.1 | 2025-07-24 | 新增“代码规范”章节。 | Gemini |
| V2.2 | 2025-07-24 | 为核心功能模块增加“设计描述”，以指导页面构建。 | Gemini |

## **1\. 引言**

### **1.1 项目背景**

当前，开发者与运维团队在管理日益碎片化的服务器时，普遍使用宝塔面板等工具。然而，这些工具存在着**界面体验不一、版本更新导致UI割裂、多面板管理繁琐**等核心痛点。用户需要在不同的浏览器标签页中切换，并适应不同版本的操作逻辑，极大地降低了管理效率和体验。

### **1.2 产品概述**

“玲珑OS”是一个**面向多面板API的统一前端操作环境 (A Unified Frontend for Multi-Panel APIs)**。它并非要取代宝塔等后端面板，而是为其提供一个统一、现代、高效的“外壳”。通过一个仿原生操作系统的Web界面，“玲珑OS”将用户分散在不同服务器、不同版本的管理面板聚合到同一个工作空间中，提供一致、流畅的操作体验。

### **1.3 目标用户**

| 用户角色 | 核心诉求 |
| :---- | :---- |
| **中小型企业运维工程师** | 在一个界面中高效管理多个客户或项目的服务器，提升响应速度。 |
| **独立开发者/站长** | 简化多台服务器的日常维护工作，降低心智负担，聚焦于开发。 |
| **技术团队** | 获得一个统一、可扩展的运维操作平台，便于团队协作和权限管理。 |

### **1.4 设计原则**

* **适配器驱动 (Adapter-Driven)**：核心逻辑与具体API实现解耦，通过适配器模式保证极高的扩展性。  
* **体验一致性 (Unified UI/UX)**：无论后端如何变化，前端始终提供稳定、统一的操作体验。  
* **聚合管理 (Aggregated Management)**：打破面板间的壁垒，提供跨实例的聚合视图与操作能力。  
* **安全为本 (Security First)**：所有敏感数据（如API密钥）在本地加密存储，不经过任何第三方服务器。

## **2\. 产品功能需求**

### **2.1 核心功能模块**

#### **模块FR-0：系统入口与认证 (System Entry & Authentication)**

* **设计描述**：登录页面采用居中布局，背景为富有科技感的动态渐变或高质量静态图片。视觉焦点集中在包含Logo、产品名称、用户名/密码输入框和登录按钮的卡片上。整体风格简洁、专业，提供清晰的输入反馈和错误提示。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-0.1** | 用户登录 | 作为用户，我希望能通过输入账号密码，安全地登录到我的“玲珑OS”工作空间。 | 1\. 提供一个独立的登录页面。 2\. 页面包含用户名/邮箱输入框、密码输入框和“登录”按钮。 3\. 提供“记住我”选项，以便在一段时间内免登录。 | 1\. 输入正确的凭据后，能成功跳转到系统主桌面。 2\. 输入错误的凭据，页面会显示明确的错误提示。 | **高** |
| **FR-0.2** | 二次验证(2FA) | 作为注重安全的用户，我希望在密码验证后，通过输入动态验证码来增强账户安全性。 | 1\. 在密码验证成功后，若用户已开启2FA，则跳转到2FA验证页面。 2\. 页面提示用户输入身份验证器App中的6位动态码。 | 1\. 已开启2FA的用户在密码正确后，会看到2FA输入界面。 2\. 输入正确的动态码后能成功登录。 3\. 输入错误的动态码会提示错误。 | **中** |

#### **模块FR-1：桌面系统 (Desktop System)**

* **设计描述**：主桌面是系统的核心视觉区域。背景支持动态壁纸，营造沉浸感。图标和组件遵循预设的网格系统布局，确保视觉整洁。图标设计风格统一、现代，并提供清晰的交互状态（悬停、选中等）。小组件采用卡片式设计，半透明背景，与壁纸形成良好融合。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-1.1** | 图标网格系统 | 作为用户，我希望桌面图标能自动对齐到网格，以便保持桌面整洁。 | 1\. 桌面存在一个不可见的网格。 2\. 所有图标和组件在创建和拖动时，默认吸附到最近的网格点。 | 1\. 拖动图标后松开，图标自动对齐到网格。 2\. 多个图标能沿网格线整齐排列。 | **高** |
| **FR-1.2** | 图标自由布局 | 作为用户，我希望能临时取消网格吸附，以便将图标放置在任意精确位置。 | 按住Alt键拖动图标时，网格吸附功能临时失效，允许像素级自由放置。 | 按住Alt键拖动图标，可以将其放置在网格线之间的任意位置。 | **中** |
| **FR-1.3** | 图标交互反馈 | 作为用户，我希望与图标交互时能得到清晰的视觉反馈，以便了解当前状态。 | 图标应具备默认、悬停（高亮/放大）、选中（背景色）、拖拽中（半透明）四种视觉状态。 | 1\. 鼠标悬停在图标上时，图标有高亮效果。 2\. 单击图标后，图标有选中背景。 | **高** |
| **FR-1.4** | 图标多选操作 | 作为用户，我希望能像在Windows中一样选择多个图标，以便进行批量操作。 | 1\. 支持在桌面空白处拖拽出选框，选中框内所有图标。 2\. 支持Ctrl+单击进行不连续多选。 3\. 支持Shift+单击进行连续多选。 | 1\. 框选功能可用。 2\. Ctrl和Shift多选功能符合预期。 | **高** |
| **FR-1.5** | 自定义小组件 | 作为运维，我希望能将关键性能指标以小组件形式放在桌面，以便实时监控。 | 1\. 提供小组件库，包含时钟、天气、服务器性能图等。 2\. 支持拖拽添加、移动、调整小组件大小。 3\. 支持iFrame嵌入和自定义代码渲染。 | 1\. 可从库中成功添加一个性能图表小组件到桌面。 2\. 小组件可以被移动和调整大小。 | **中** |

#### **模块FR-2：窗口系统 (Windowing System)**

* **设计描述**：窗口是所有应用的载体，采用现代化的圆角卡片设计。标题栏左侧为应用图标和名称，右侧为风格统一的控制按钮。窗口背景采用类似Mica/Acrylic的半透明模糊效果，能隐约透出桌面壁纸，增加层次感。窗口的拖动、缩放、最大化/最小化等操作均配有流畅、自然的过渡动画。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-2.1** | 窗口基础操作 | 作为用户，我希望能像原生系统一样打开、移动、关闭和缩放窗口。 | 1\. 窗口包含带图标和标题的标题栏。 2\. 标题栏支持按住拖动。 3\. 窗口包含最小化、最大化/还原、关闭按钮。 4\. 窗口四周边缘可拖拽调整大小。 | 1\. 应用窗口可以被成功创建和关闭。 2\. 窗口可以被拖动到屏幕任意位置。 3\. 窗口大小可以通过拖拽边缘改变。 | **高** |
| **FR-2.2** | 窗口状态视觉 | 作为用户，我希望能清晰地分辨出哪个是当前活动窗口。 | 活动窗口在视觉上（如阴影、标题栏颜色）要与非活动窗口有明显区别。窗口状态切换时有流畅的过渡动画。 | 1\. 点击一个窗口，该窗口变为活动状态，视觉效果变化。 2\. 其他窗口变为非活动状态，视觉效果变灰。 | **高** |
| **FR-2.3** | 窗口布局管理 | 作为用户，我希望能快速地将窗口排列在屏幕上，以便进行分屏操作。 | 1\. 将窗口拖拽到屏幕左/右边缘时，自动占据50%屏幕。 2\. 鼠标悬停在最大化按钮上，出现Snap Layouts面板供快速选择布局。 | 1\. 拖拽窗口到屏幕左边缘，窗口自动变为左半屏。 2\. 可通过Snap Layouts将两个窗口设置为左右分屏。 | **中** |

#### **模块FR-3：系统栏 (System Bars)**

* **设计描述**：顶部信息栏设计为纤细、半透明的条状，不干扰主要工作区。底部任务栏默认居中，图标有清晰的悬停和点击动效，运行中的应用下方有状态指示条。开始菜单和托盘区的弹出面板均采用与窗口一致的圆角和半透明模糊设计风格。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-3.1** | 顶部信息栏 | 作为用户，我希望能在一个固定的地方看到系统时间和通知等重要信息。 | 1\. 屏幕顶部固定显示信息栏。 2\. 左侧显示Logo，中央显示时钟，右侧聚合系统托盘图标（告警、网络、用户菜单等）。 | 1\. 顶部栏始终可见。 2\. 时钟能正确显示当前时间。 3\. 点击用户头像能弹出菜单。 | **高** |
| **FR-3.2** | 底部任务栏 | 作为用户，我希望能方便地启动和切换应用。 | 1\. 屏幕底部固定显示任务栏，默认居中布局（可设为左对齐）。 2\. 包含开始按钮、已固定和正在运行的应用图标。 | 1\. 点击开始按钮能打开开始菜单。 2\. 点击运行中的应用图标能切换到该应用窗口。 | **高** |

#### **模块FR-4：任务管理器 (Task Manager)**

* **设计描述**：任务管理器是一个多标签页的应用窗口。整体采用数据驱动的设计，以表格和图表为主。进程列表使用表格展示，关键指标（如CPU、内存占用）使用颜色（绿、黄、红）和数据条进行可视化，便于快速识别高负载进程。服务管理列表则更简洁，重点突出服务状态和操作按钮。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-4.1** | 远程进程管理 | 作为运维，我希望能查看并管理远程服务器上的进程，以便排查问题。 | 1\. 通过API获取并以列表形式展示远程服务器的当前进程。 2\. 支持按进程名称搜索，按CPU、内存等指标排序。 3\. 提供结束指定远程进程的功能。 | 1\. 能成功加载并显示远程服务器的进程列表。 2\. 搜索和排序功能可用。 3\. 点击“结束进程”后，目标进程消失。 | **中** |
| **FR-4.2** | 服务管理 | 作为运维，我希望能快速重启Nginx服务，而无需登录服务器。 | 以列表形式实时显示Nginx、MySQL等核心服务的运行状态，并提供启动、停止、重启等快捷操作按钮。 | 1\. 能正确显示服务的运行状态。 2\. 点击“重启”按钮后，服务状态能正确刷新。 | **中** |

#### **模块FR-5：弹窗系统 (Notification & Dialog System)**

* **设计描述**：通知（Toast）从屏幕右下角滑入，短暂显示后自动滑出，风格轻量不打扰。对话框（Dialog）和警告（Alert）则采用模态窗口形式，使背景变暗以聚焦用户注意力。按钮布局遵循平台习惯（如确认在右），警告框会使用醒目的图标和颜色（如红色）来强调其重要性。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-5.1** | 弹窗分类 | 作为用户，我希望能区分一般通知和需要我确认的重要操作。 | 实现三种弹窗类型：通知类（自动消失）、操作确认类（模态，需用户交互）、错误警告类（模态，关联解决方案）。 | 1\. “操作成功”提示是通知类。 2\. “确认删除”是操作确认类。 3\. “API连接失败”是错误警告类。 | **高** |

#### **模块FR-6：文件管理 (File Manager)**

* **设计描述**：采用经典的三段式布局：左侧为导航树（收藏夹、面板实例列表），顶部为工具栏（操作按钮）和地址栏（面包屑导航），主区域为文件和文件夹的展示区。支持图标和列表两种视图模式切换。整体设计语言干净、高效，注重信息的清晰传达。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-6.1** | 多标签页浏览 | 作为用户，我希望能同时打开两个不同服务器的目录进行文件对比和操作。 | 允许用户在同一个文件管理器窗口内打开多个不同的目录路径，每个路径在一个独立的标签页中。 | 1\. 可以打开多个标签页。 2\. 可以在不同标签页之间切换。 3\. 关闭一个标签页不影响其他标签页。 | **高** |
| **FR-6.2** | 文件基础操作 | 作为用户，我希望能像在本地电脑一样对远程文件进行增删改查。 | 实现新建（文件/文件夹）、复制、剪切、粘贴、重命名、删除等所有标准文件操作。 | 1\. 可以在远程目录新建文件夹。 2\. 可以成功复制并粘贴文件。 3\. 可以重命名和删除文件。 | **高** |

#### **模块FR-7：回收站 (Recycle Bin)**

* **设计描述**：界面设计为文件管理器的简化版。顶部为“还原选中项”和“清空回收站”两个主要操作按钮。主区域为已删除文件的列表视图，包含文件名、原始路径、删除日期等关键信息列。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-7.1** | 文件还原 | 作为用户，我不小心删除了一个重要文件，希望能从回收站找回来。 | 1\. 支持将回收站内的文件还原到其原始路径。 2\. 支持选择一个全新的路径进行还原。 | 1\. 在回收站中选中文件，点击“还原”，文件从回收站消失并出现在原路径。 | **中** |
| **FR-7.2** | 自动清理 | 作为用户，我不希望回收站文件无限期占用空间，希望能自动清理。 | 用户可配置自动清理策略，如“删除超过30天的文件”或“当容量超过5GB时清理最旧的文件”。 | 1\. 开启策略后，符合条件的文件会被自动永久删除。 | **低** |

#### **模块FR-8：右键菜单系统 (Context Menu System)**

* **设计描述**：右键菜单是一个在鼠标点击位置出现的浮动面板。设计简洁，列表项包含图标、文本和快捷键提示。支持分隔线和多级子菜单的展开。菜单的出现和消失有快速、轻微的动画效果。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-8.1** | 上下文感知 | 作为用户，我希望在不同对象上右键能看到不同的、相关的操作选项。 | 系统能精确识别右键点击的目标类型（桌面、文件、文件夹等），并调用相应的菜单构建逻辑。 | 1\. 在桌面空白处右键，出现“新建”、“排序”等选项。 2\. 在文件图标上右键，出现“打开”、“复制”等选项。 | **高** |
| **FR-8.2** | 菜单项注册制 | 作为开发者，我希望能为我的应用添加自定义的右键菜单项。 | 系统提供一个registerMenuItem服务，允许任何模块或应用注册菜单项，并指定其适用的上下文和执行的回调函数。 | 1\. 压缩应用可以成功注册一个“添加到压缩文件”的菜单项到文件和文件夹的右键菜单中。 | **中** |

#### **模块FR-9：内容关联与打开方式 (Content Association)**

* **设计描述**：“打开方式”菜单是右键菜单的一个子菜单项。选择“选择其他应用...”后，会弹出一个专门的对话框。该对话框以列表形式展示所有兼容的应用（包含图标和名称），并提供一个文件浏览器按钮用于选择自定义程序，底部有一个“始终使用此应用打开”的复选框。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-9.1** | 默认打开方式 | 作为用户，我希望能双击文本文件就用文本编辑器打开。 | 系统预设一套常见文件扩展名与内置应用的默认打开关系。双击文件时，根据此关系启动相应应用。 | 双击一个.txt文件，文本编辑器应用窗口被打开，并加载该文件内容。 | **高** |
| **FR-9.2** | 自定义打开方式 | 作为用户，我希望能将.md文件默认用Markdown编辑器打开，而不是普通文本编辑器。 | 1\. 在文件的右键“打开方式”子菜单中，提供“选择其他应用...”选项。 2\. 在弹出的应用选择器中，允许用户选择一个新应用并勾选“始终使用此应用打开”。 | 1\. 可通过“打开方式”菜单用另一个应用打开文件。 2\. 设定新的默认应用后，下次双击该类型文件会用新应用打开。 | **中** |

#### **模块FR-10：关于与信息 (About & Information)**

* **设计描述**：“关于”页面是一个简洁的模态对话框。顶部是应用的Logo，中间是产品名称、版本号和版权信息，底部是一个用于显示开源致谢的滚动区域或链接。整体设计保持品牌一致性。

| ID | 功能名称 | 用户故事 | 功能描述 | 验收标准 | 优先级 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **FR-10.1** | 关于页面 | 作为用户，我希望能方便地查看应用的版权和版本信息。 | 1\. 在用户菜单或系统设置中提供“关于”入口。 2\. “关于”页面以模态框或独立页面形式展示。 3\. 页面内容包含应用Logo、名称、当前版本号、版权声明（© 2025 LingLong OS Team. All Rights Reserved.）。 | 1\. 可从UI上找到并打开“关于”页面。 2\. 页面正确显示Logo、名称、版本号和版权信息。 | **低** |

### **2.2 补充功能模块**

(此部分的功能可作为后期迭代，优先级普遍为中或低)

* **应用生态 (Application Ecosystem)**：核心是应用商店和应用沙箱。  
* **系统控制中心 (System Control Center)**：核心是面板连接管理和个性化设置。  
* **任务与进程扩展 (Task & Process Extensions)**：核心是计划任务和进程快照。

## **3\. 非功能性需求**

| 类别 | 需求描述 |
| :---- | :---- |
| **性能需求** | 1\. 系统首次加载时间在现代网络环境下应小于3秒。 2\. 窗口打开、关闭等操作的UI响应时间应小于100毫秒。 3\. CPU和内存占用应保持在合理水平，不应造成浏览器卡顿。 |
| **兼容性需求** | 兼容最新版本的Chrome、Edge、Firefox浏览器。界面在PC和主流平板设备上应能良好地响应式布局。 |
| **安全性需求** | 1\. 所有面板API密钥等敏感信息必须使用Web Crypto API在本地加密存储。 2\. 与后端面板的所有API通信必须强制使用HTTPS。 3\. 提供二次验证（2FA）功能来保护“玲珑OS”账户。 |
| **可用性需求** | 1\. 遵循WCAG 2.1 AA标准，支持屏幕阅读器和全键盘操作。 2\. 提供高对比度主题。 3\. 交互流程应直观，符合主流操作系统的用户习惯。 |
| **稳定性需求** | 1\. 内置崩溃恢复机制，单个应用窗口崩溃不应影响整个系统的运行。 2\. 系统应能处理API请求失败、网络中断等异常情况，并给予用户明确提示。 |

## **4\. 技术栈与核心库**

### **4.1 架构理念**

* **前端驱动**：采用现代化的前端技术栈，构建高度模块化、可维护、高性能的单页应用（SPA）。  
* **Monorepo**：项目采用 pnpm \+ Turborepo 进行管理，将不同的功能模块（如核心桌面、应用、组件库、适配器）作为独立的包，便于代码复用、统一依赖管理和高效的CI/CD。  
* **分层抽象**：通过引入**API适配器**和**数据持久化适配器**，实现核心业务逻辑与外部服务、本地存储的完全解耦。

### **4.2 技术选型**

| 领域 | 技术/库 | 理由 |
| :---- | :---- | :---- |
| **项目管理** | pnpm \+ Turborepo | 高效的Monorepo管理方案，便于代码复用和统一构建。 |
| **核心框架** | Vue 3.x \+ Vite | 现代、高效的开发体验，强大的生态系统。 |
| **UI与样式** | 自研UI库 \+ UnoCSS | 确保视觉统一、性能极致，且完全自主可控。 |
| **状态管理** | Pinia | Vue官方推荐，轻量、直观、对TypeScript支持友好。 |
| **核心功能** | Monaco Editor, Xterm.js, ECharts, axios | 均为业界领先的库，能快速实现高质量的核心功能。 |

## **5\. 架构设计与项目规划**

### **5.1 架构核心原则**

为确保长期的可迭代性和扩展性，架构设计遵循以下核心原则：

* **领域驱动设计 (DDD)**：将复杂的系统按业务领域（如面板管理、文件系统、用户会话）进行划分，每个领域拥有自己的模型和服务，降低模块间的耦合度。  
* **依赖注入 (DI)**：服务与服务、服务与组件之间不直接实例化依赖，而是通过一个统一的容器来提供和注入依赖。这使得任何模块都可以被轻松替换和测试。  
* **事件驱动架构 (EDA)**：模块间通过一个全局的事件总线进行低耦合通信。一个模块只需发布事件，而无需关心哪些模块会消费它，这极大地增强了系统的可扩展性。

### **5.2 Monorepo 项目架构图**

下图描述了基于Turborepo和领域驱动设计思想的Monorepo架构。

\+-------------------------------------------------------------------------+  
|                                  apps/desktop                           |  
|                  (主应用外壳: 桌面, 窗口系统, 系统栏)                     |  
\+------------------------------------^------------------------------------+  
                                     | (Imports & Renders)  
\+------------------------------------|------------------------------------+  
|               packages/apps/\* (文件管理器, 终端, 设置等)                |  
|                      (独立的功能应用，包含业务逻辑)                       |  
\+--------^--------------^-----------------------------^------------------+  
         | (Injects &    | (Uses)                      | (Implements)  
         |  Dispatches   |                             |  
         |  Events)      |                             |  
\+--------|--------------|-----------------------------|------------------+  
| packages/services/\* | packages/ui                 | packages/shared-types |  
| (核心服务: API, 存储) | (自研UI组件库: Button, Modal) | (全局TS类型定义)    |  
\+--------^--------------^-----------------------------^------------------+  
         | (Injects)    |                             | (Used by all)  
\+--------|--------------|------------------------------------------------+  
| packages/adapters/\* |  
| (适配器: 宝塔, 1Panel, IndexedDB, SQLite)                              |  
\+-------------------------------------------------------------------------+

### **5.3 核心系统：配置驱动的桌面**

桌面布局（图标、小组件及其位置）并非硬编码在UI中，而是由一份JSON配置动态生成。

* **配置化JSON结构**:  
  {  
    "version": 1,  
    "desktopItems": \[  
      {  
        "id": "item-001",  
        "type": "app-icon",  
        "appId": "file-manager",  
        "position": { "x": 0, "y": 0 }  
      },  
      {  
        "id": "item-002",  
        "type": "widget",  
        "widgetId": "performance-monitor",  
        "position": { "x": 5, "y": 0 },  
        "size": { "width": 2, "height": 1 }  
      }  
    \]  
  }

* **数据持久化**:  
  1. **DesktopConfigService**: 这是一个核心服务，负责管理桌面的JSON配置。  
  2. **加载**: 系统启动时，该服务通过**持久化服务 (PersistenceService)** 从数据库（Web端为IndexedDB）加载这份JSON。  
  3. **渲染**: 桌面UI组件是一个“哑”组件，它仅订阅DesktopConfigService中的配置数据，并根据JSON内容循环渲染出图标和小组件。  
  4. **保存**: 当用户在桌面上进行操作（如移动图标、添加小组件）时，UI层会通知DesktopConfigService更新JSON配置，该服务再调用PersistenceService将新的JSON保存回数据库。

### **5.4 基于Turborepo的开发规划**

采用Turborepo管理Monorepo架构，旨在通过**任务编排**和**远程缓存**，最大化开发效率和构建速度。

* **视图功能分离**:  
  * **主视图 (apps/desktop)**: 仅作为承载所有UI的“外壳”，负责桌面、窗口系统等基础容器的渲染。  
  * **功能视图 (packages/apps/\*)**: 每个核心功能（如文件管理、设置）都是一个独立的、可独立开发和测试的应用包。这种分离使得团队可以并行开发不同功能，互不干扰。  
* **建立公共库**:  
  * **packages/ui**: 建立一个完全自研的UI组件库。任何UI相关的改动只发生在这个包内，所有依赖它的应用都能自动获得更新，保证了UI的统一性。  
  * **packages/services/\***: 按照领域划分，建立多个核心服务包（如packages/services/api-gateway, packages/services/storage），取代原先单一的core包，职责更清晰。  
  * **packages/shared-types**: 建立统一的TypeScript类型定义，为所有包提供类型安全保障和统一的数据契约。  
* **提升开发与构建效率**:  
  * **增量构建**: Turborepo会分析依赖关系图，只重新构建发生变化和受其影响的包，从而极大地**减少了编译耗时**。例如，修改packages/ui中的一个按钮样式，只会重新构建ui包和依赖它的应用，而不会触及services或adapters。  
  * **并行执行**: 在CI/CD环境中，Turborepo可以并行执行多个包的测试、Lint和构建任务，缩短流水线运行时间。  
  * **远程缓存**: 团队成员和CI/CD可以共享构建缓存。如果一个开发者已经构建过某个版本的代码，其他人或CI再次构建时可以直接下载缓存，实现近乎即时的构建，**极大提升了开发效率**。

### **5.5 迭代规划**

| 阶段 | 核心目标 | 重点开发包 |
| :---- | :---- | :---- |
| **第一阶段 (MVP)** | 验证核心适配器与前端框架 | apps/desktop, packages/services/\*, packages/ui, packages/adapters/baota, packages/apps/file-manager |
| **第二阶段 (功能完善)** | 丰富核心应用，上线应用市场 | 完善所有packages/apps/\*，开发apps/store，完善packages/services/auth中的权限服务。 |
| **第三阶段 (生态扩展)** | 开放适配器平台，引入智能化 | 编写适配器开发文档，开发更多packages/adapters/\*，探索AIOps相关功能。 |

## **6\. 代码规范 (Coding Standards)**

为确保代码质量、一致性和长期可维护性，所有贡献者必须遵循以下规范。这些规范将通过代码质量工具强制执行。

### **6.1 通用规范**

| 类别 | 规范内容 |
| :---- | :---- |
| **命名规范** | \- **文件/目录**: kebab-case (例如 file-manager, api-service.ts)。\<br\>- **Vue组件**: PascalCase (例如 AppHeader.vue, ModalDialog.vue)。\<br\>- **变量/函数**: camelCase (例如 const userData, function getUserInfo() {})。\<br\>- **常量**: UPPER\_CASE (例如 const MAX\_RETRIES \= 3)。 |
| **注释规范** | \- **函数/方法**: 必须使用 **JSDoc** 格式进行注释，说明函数功能、参数和返回值。\<br\>- **复杂逻辑**: 对于复杂的算法、业务逻辑或临时的解决方案，必须添加行内或块级注释进行解释。 |
| **Git提交规范** | 严格遵循 **Conventional Commits** 规范。提交信息格式为 \<type\>(\<scope\>): \<subject\>。\<br\>- **feat**: 新功能\<br\>- **fix**: Bug修复\<br\>- **docs**: 文档变更\<br\>- **style**: 代码风格（不影响代码运行的变动）\<br\>- **refactor**: 代码重构\<br\>- **perf**: 性能优化\<br\>- **test**: 增加测试\<br\>- **chore**: 构建过程或辅助工具的变动 |

### **6.2 前端规范**

| 类别 | 规范内容 |
| :---- | :---- |
| **TypeScript** | \- 启用并遵循tsconfig.json中的strict模式。\<br\>- **严禁**使用any类型，除非在极少数无法避免的情况下，并需添加注释说明。\<br\>- 所有跨包共享的数据结构，必须在packages/shared-types中定义并导出。 |
| **Vue.js** | \- **统一使用** \<script setup\> 语法糖。\<br\>- \<script\>块内部代码顺序：imports \-\> defineProps / defineEmits \-\> reactive state \-\> functions \-\> lifecycle hooks。\<br\>- 组件Props必须有明确的类型定义，对于非必需的props必须提供default值。 |
| **样式规范** | \- **严禁**在packages/apps/\*的应用级组件中直接使用UnoCSS的原子化类。\<br\>- 所有样式必须通过packages/ui中提供的语义化组件（如\<l-button\>,\<l-card\>）来实现。\<br\>- packages/ui内部在封装组件时，可以使用UnoCSS原子化类。 |

### **6.3 代码质量工具**

| 工具 | 用途 |
| :---- | :---- |
| **ESLint** | 用于JavaScript和TypeScript的静态代码分析，确保代码符合语法和风格规则。 |
| **Prettier** | 用于自动化代码格式化，确保整个项目代码风格的绝对一致。 |
| **Stylelint** | 用于CSS和UnoCSS的规范检查，尤其是在packages/ui库中。 |
| **Husky \+ lint-staged** | 设置Git pre-commit钩子。在每次提交前，自动对暂存区的文件运行ESLint和Prettier，强制保证入库代码的质量。 |

## **7\. 附录 A：术语表与参考 (Glossary & References)**

### **7.1 术语表**

| 术语 | 解释 |
| :---- | :---- |
| **面板实例** | 一个已连接的后端管理面板，如一个宝塔面板服务器。 |
| **适配器** | 用于将“玲珑OS”的标准请求转换为特定面板API格式的中间件模块。 |
| **玲珑标准格式** | “玲珑OS”内部定义的一套统一的数据结构，用于应用层与适配器层之间的数据交换。 |

### **7.2 参考项目**

* **Puter.com**: 性能优化与OS级交互体验的标杆。  
* **kodbox**: 成熟Web OS产品，功能完备性的参考。  
* **win12 (tjy-gitnub)**: Vue实现的桌面UI，核心组件的直接代码参考。